<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
    <title>Book Search | IT 4403 Project</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .page-number {
            cursor: pointer;
            padding: 5px 10px;
            margin: 0 2px;
            border: 1px solid #007bff;
            border-radius: 3px;
        }

        .page-number.active {
            background-color: #007bff;
            color: white;
            font-weight: bold;
        }

        .view-toggle {
            margin: 10px 0;
        }

        .view-toggle button {
            padding: 5px 10px;
            margin-right: 10px;
            border: 1px solid #007bff;
            border-radius: 3px;
            background-color: #f0f0f0;
            cursor: pointer;
        }

        .view-toggle button.active {
            background-color: #007bff;
            color: white;
        }

        #results.grid-view .result-item {
            display: inline-block;
            width: 30%;
            margin: 10px;
            text-align: center;
        }

        #results.list-view .result-item {
            display: block;
            width: 100%;
            margin: 10px 0;
        }

        .result-item img {
            max-width: 100px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <ul>
            <li><a href="#" class="nav-link" data-target="home-section">Home</a></li>
            <li><a href="#" class="nav-link" data-target="bookshelf-section">My Bookshelf</a></li>
        </ul>
    </nav>
    
    <!-- Main Content -->
    <main id="main-content">
        <!-- Home Section -->
        <section id="home-section">
            <h1>Welcome to the Book Search Application</h1>
            
            <!-- Book Search Section -->
            <div id="search-section">
                <input type="text" id="search-input" placeholder="Enter book title or keyword" />
                <button id="search-button">Search</button>
            </div>

            <!-- View Toggle Buttons -->
            <div class="view-toggle">
                <button id="grid-view-button" class="active">Grid View</button>
                <button id="list-view-button">List View</button>
            </div>
            
            <!-- Results Display Section -->
            <div id="results-section">
                <h2>Search Results</h2>
                <div id="results" class="grid-view"></div>
                <div id="pagination">
                    <span id="page-indicator"></span> <!-- Page Indicator -->
                </div>
            </div>
        </section>

        <!-- Bookshelf Section -->
        <section id="bookshelf-section" style="display: none;">
            <h1>My Bookshelf</h1>
            <div id="bookshelf-content">
                <!-- Bookshelf content will be loaded here -->
            </div>
        </section>

        <!-- Book Details Section -->
        <section id="book-details-section" style="display: none;">
            <h2>Book Details</h2>
            <div id="book-details"></div>
            <button id="save-to-bookshelf" style="display:none;">Save to Bookshelf</button> <!-- Save button -->
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 Kevin Co. All Rights Reserved.</p>
    </footer>

    <script>
        $(document).ready(function() {
            let currentPage = 1;
            const resultsPerPage = 10;
            const apiKey = 'AIzaSyC2lPVELazlhLT8Nr66xG_HLruUBHP-CLo'; // Your API Key

            // Navigation system
            $('.nav-link').click(function(e) {
                e.preventDefault();
                const target = $(this).data('target');
                $('section').hide();
                $(`#${target}`).show();
            });

            // Function to search for books
            function searchBooks(query, page = 1) {
                const startIndex = (page - 1) * resultsPerPage;
                const url = `https://www.googleapis.com/books/v1/volumes?q=${query}&startIndex=${startIndex}&maxResults=${resultsPerPage}&key=${apiKey}`;

                $.getJSON(url, function(data) {
                    if (data.items) {
                        displayBooks(data.items);
                        setupPagination(data.totalItems, query); // Setup pagination with total items
                    } else {
                        $('#results').empty().append('<p>No results found.</p>');
                        $('#pagination').empty(); // Clear pagination if no results
                        $('#page-indicator').text(''); // Clear page indicator
                    }
                }).fail(function() {
                    $('#results').empty().append('<p>Error retrieving data. Please try again.</p>');
                    $('#pagination').empty(); // Clear pagination on error
                    $('#page-indicator').text(''); // Clear page indicator
                });
            }

            // Function to display books
            function displayBooks(books) {
                $('#results').empty(); // Clear previous results
                books.forEach(book => {
                    const title = book.volumeInfo.title || 'No Title';
                    const cover = book.volumeInfo.imageLinks ? book.volumeInfo.imageLinks.thumbnail : 'images/no-image.jpg';
                    $('#results').append(`<div class="result-item" data-id="${book.id}" data-title="${title}" data-thumbnail="${cover}">
                        <h3>${title}</h3>
                        <img src="${cover}" alt="${title}" />
                    </div>`);
                });

                // Add click event to display book details
                $('.result-item').click(function() {
                    const bookId = $(this).data('id');
                    const title = $(this).data('title');
                    const thumbnail = $(this).data('thumbnail');
                    displayBookDetails(bookId, title, thumbnail);
                });
            }

            // View toggle functionality
            $('#grid-view-button').click(function() {
                $('#results').removeClass('list-view').addClass('grid-view');
                $('.view-toggle button').removeClass('active');
                $(this).addClass('active');
            });

            $('#list-view-button').click(function() {
                $('#results').removeClass('grid-view').addClass('list-view');
                $('.view-toggle button').removeClass('active');
                $(this).addClass('active');
            });

            // Search button click event
            $('#search-button').click(function() {
                const query = $('#search-input').val();
                if (query) {
                    currentPage = 1; // Reset to first page
                    searchBooks(query);
                } else {
                    $('#results').empty().append('<p>Please enter a search term.</p>');
                }
            });
        });
    </script>
</body>
</html>
