<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
    <title>Book Search | IT 4403 Project</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="bookshelf.html">My Bookshelf</a></li>
        </ul>
    </nav>
    
    <!-- Main Content -->
    <main>
        <h1>Welcome to the Book Search Application</h1>
        
        <!-- Book Search Section -->
        <section id="search-section">
            <input type="text" id="search-input" placeholder="Enter book title or keyword" />
            <button id="search-button">Search</button>
        </section>
        
        <!-- Results Display Section -->
        <section id="results-section">
            <h2>Search Results</h2>
            <div id="results"></div>
            <div id="pagination"></div>
        </section>

        <!-- Book Details Section -->
        <section id="book-details-section" style="display:none;">
            <h2>Book Details</h2>
            <div id="book-details"></div>
            <button id="save-to-bookshelf" style="display:none;">Save to Bookshelf</button> <!-- Save button -->
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 Kevin Co. All Rights Reserved.</p>
    </footer>

    <script>
        $(document).ready(function() {
            let currentPage = 1;
            const resultsPerPage = 10;

            // Function to search for books
            function searchBooks(query, page = 1) {
                const apiKey = 'YOUR_API_KEY'; // Replace with your actual API key
                const startIndex = (page - 1) * resultsPerPage;
                const url = `https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(query)}&key=${apiKey}&startIndex=${startIndex}&maxResults=${resultsPerPage}`;

                $.getJSON(url, function(data) {
                    displayBooks(data.items);
                    setupPagination(data.totalItems, query);
                }).fail(function() {
                    $('#results').empty().append('<p>Error retrieving data.</p>');
                });
            }

            // Function to display books
            function displayBooks(books) {
                $('#results').empty();
                if (books && books.length > 0) {
                    books.forEach(book => {
                        const title = book.volumeInfo.title || 'No Title';
                        const cover = book.volumeInfo.imageLinks ? book.volumeInfo.imageLinks.thumbnail : 'images/no-image.jpg';
                        $('#results').append(`<div class="result-item" data-id="${book.id}" data-title="${title}" data-thumbnail="${cover}">
                            <h3>${title}</h3>
                            <img src="${cover}" alt="${title}" />
                        </div>`);
                    });

                    // Add click event to display book details
                    $('.result-item').click(function() {
                        const bookId = $(this).data('id');
                        const title = $(this).data('title');
                        const thumbnail = $(this).data('thumbnail');
                        displayBookDetails(bookId, title, thumbnail);
                    });
                } else {
                    $('#results').append('<p>No results found.</p>');
                }
            }

            // Function to set up pagination
            function setupPagination(totalItems, query) {
                const totalPages = Math.ceil(totalItems / resultsPerPage);
                $('#pagination').empty();
                for (let i = 1; i <= totalPages; i++) {
                    $('#pagination').append(`<span class="page-number">${i}</span>`);
                }
                $('.page-number').click(function() {
                    currentPage = $(this).text();
                    searchBooks(query, currentPage);
                });
            }

            // Display detailed information about the selected book
            function displayBookDetails(bookId, title, thumbnail) {
                const apiUrl = `https://www.googleapis.com/books/v1/volumes/${bookId}`;
                $.getJSON(apiUrl, function(data) {
                    $('#book-details').empty();
                    const authors = data.volumeInfo.authors ? data.volumeInfo.authors.join(', ') : 'Unknown Author';
                    const description = data.volumeInfo.description ? data.volumeInfo.description : 'No Description Available';

                    $('#book-details').append(`
                        <h3>${title}</h3>
                        <h4>By: ${authors}</h4>
                        <img src="${thumbnail}" alt="${title}" />
                        <p>${description}</p>
                    `);
                    $('#book-details-section').show();
                });
            }

            // Search button click event
            $('#search-button').on('click', function() {
                const query = $('#search-input').val().trim();
                if (query) {
                    currentPage = 1; // Reset to the first page
                    searchBooks(query, currentPage);
                } else {
                    alert('Please enter a search term.');
                }
            });
        });
    </script>
</body>
</html>
